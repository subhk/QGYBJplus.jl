<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Initial Conditions · QGYBJ.jl</title><meta name="title" content="Initial Conditions · QGYBJ.jl"/><meta property="og:title" content="Initial Conditions · QGYBJ.jl"/><meta property="twitter:title" content="Initial Conditions · QGYBJ.jl"/><meta name="description" content="Documentation for QGYBJ.jl."/><meta property="og:description" content="Documentation for QGYBJ.jl."/><meta property="twitter:description" content="Documentation for QGYBJ.jl."/><meta property="og:url" content="https://subhk.github.io/QGYBJ.jl/stable/guide/initial_conditions/"/><meta property="twitter:url" content="https://subhk.github.io/QGYBJ.jl/stable/guide/initial_conditions/"/><link rel="canonical" href="https://subhk.github.io/QGYBJ.jl/stable/guide/initial_conditions/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">QGYBJ.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/">Installation</a></li><li><a class="tocitem" href="../../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../../worked_example/">Worked Example</a></li></ul></li><li><span class="tocitem">Physics &amp; Theory</span><ul><li><a class="tocitem" href="../../physics/overview/">Model Overview</a></li><li><a class="tocitem" href="../../physics/qg_equations/">QG Equations</a></li><li><a class="tocitem" href="../../physics/ybj_plus/">YBJ+ Wave Model</a></li><li><a class="tocitem" href="../../physics/wave_mean/">Wave-Mean Interaction</a></li><li><a class="tocitem" href="../../physics/numerical_methods/">Numerical Methods</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../stratification/">Stratification</a></li><li class="is-active"><a class="tocitem" href>Initial Conditions</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Random-Initialization"><span>Random Initialization</span></a></li><li><a class="tocitem" href="#Coherent-Structures"><span>Coherent Structures</span></a></li><li><a class="tocitem" href="#Wave-Packets"><span>Wave Packets</span></a></li><li><a class="tocitem" href="#From-Spectra"><span>From Spectra</span></a></li><li><a class="tocitem" href="#From-Data"><span>From Data</span></a></li><li><a class="tocitem" href="#Spin-Up"><span>Spin-Up</span></a></li><li><a class="tocitem" href="#Verification"><span>Verification</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li><li><a class="tocitem" href="../simulation/">Running Simulations</a></li><li><a class="tocitem" href="../io/">I/O and Output</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../../advanced/parallel/">MPI Parallelization</a></li><li><a class="tocitem" href="../../advanced/particles/">Particle Advection</a></li><li><a class="tocitem" href="../../advanced/parallel_particles/">Parallel Particle Algorithm</a></li><li><a class="tocitem" href="../../advanced/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../advanced/performance/">Performance Tips</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/types/">Core Types</a></li><li><a class="tocitem" href="../../api/grid_state/">Grid &amp; State</a></li><li><a class="tocitem" href="../../api/physics/">Physics Functions</a></li><li><a class="tocitem" href="../../api/timestepping/">Time Stepping</a></li><li><a class="tocitem" href="../../api/particles/">Particles</a></li><li><a class="tocitem" href="../../api/">Full Index</a></li></ul></li><li><a class="tocitem" href="../../troubleshooting/">Troubleshooting</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Initial Conditions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Initial Conditions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/subhk/QGYBJ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/subhk/QGYBJ.jl/blob/main/docs/src/guide/initial_conditions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="initial-conditions"><a class="docs-heading-anchor" href="#initial-conditions">Initial Conditions</a><a id="initial-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#initial-conditions" title="Permalink"></a></h1><p>This page describes how to set up initial conditions for QGYBJ.jl simulations.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Initial conditions must be specified for:</p><ul><li><strong>Potential vorticity</strong> <span>$q$</span> (or streamfunction <span>$\psi$</span>)</li><li><strong>Wave envelope</strong> <span>$B$</span> (or wave amplitude <span>$A$</span>)</li></ul><h2 id="Random-Initialization"><a class="docs-heading-anchor" href="#Random-Initialization">Random Initialization</a><a id="Random-Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Random-Initialization" title="Permalink"></a></h2><h3 id="Random-Flow"><a class="docs-heading-anchor" href="#Random-Flow">Random Flow</a><a id="Random-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Random-Flow" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Random streamfunction with specified energy level
initialize_random_flow!(state, grid;
    energy_level = 1.0,
    seed = 42
)</code></pre><p>The random flow is band-limited to resolved wavenumbers with a specified spectral slope.</p><h3 id="Random-Waves"><a class="docs-heading-anchor" href="#Random-Waves">Random Waves</a><a id="Random-Waves-1"></a><a class="docs-heading-anchor-permalink" href="#Random-Waves" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Random wave field
initialize_random_waves!(state, grid;
    amplitude = 0.1,
    vertical_mode = 1,  # Dominant vertical mode
    seed = 123
)</code></pre><h2 id="Coherent-Structures"><a class="docs-heading-anchor" href="#Coherent-Structures">Coherent Structures</a><a id="Coherent-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Coherent-Structures" title="Permalink"></a></h2><h3 id="Single-Vortex"><a class="docs-heading-anchor" href="#Single-Vortex">Single Vortex</a><a id="Single-Vortex-1"></a><a class="docs-heading-anchor-permalink" href="#Single-Vortex" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Gaussian vortex at domain center
initialize_vortex!(state, grid;
    x0 = π,
    y0 = π,
    radius = 0.5,
    intensity = 1.0,
    sign = :cyclone  # or :anticyclone
)</code></pre><h3 id="Vortex-Pair"><a class="docs-heading-anchor" href="#Vortex-Pair">Vortex Pair</a><a id="Vortex-Pair-1"></a><a class="docs-heading-anchor-permalink" href="#Vortex-Pair" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Dipole (vortex pair)
initialize_dipole!(state, grid;
    separation = 1.0,
    intensity = 1.0,
    angle = 0.0  # Orientation
)</code></pre><h3 id="Jet"><a class="docs-heading-anchor" href="#Jet">Jet</a><a id="Jet-1"></a><a class="docs-heading-anchor-permalink" href="#Jet" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Zonal jet with specified profile
initialize_jet!(state, grid;
    jet_width = 0.5,
    jet_intensity = 1.0,
    y_center = π
)</code></pre><h2 id="Wave-Packets"><a class="docs-heading-anchor" href="#Wave-Packets">Wave Packets</a><a id="Wave-Packets-1"></a><a class="docs-heading-anchor-permalink" href="#Wave-Packets" title="Permalink"></a></h2><h3 id="Plane-Wave"><a class="docs-heading-anchor" href="#Plane-Wave">Plane Wave</a><a id="Plane-Wave-1"></a><a class="docs-heading-anchor-permalink" href="#Plane-Wave" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Plane wave with specified wavenumber
initialize_plane_wave!(state, grid;
    kx = 4,
    ky = 0,
    amplitude = 0.1,
    vertical_mode = 1
)</code></pre><h3 id="Gaussian-Packet"><a class="docs-heading-anchor" href="#Gaussian-Packet">Gaussian Packet</a><a id="Gaussian-Packet-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-Packet" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Localized wave packet
initialize_wave_packet!(state, grid;
    x0 = π,
    y0 = π,
    sigma_x = 0.5,
    sigma_y = 0.5,
    k0 = 4,     # Central wavenumber
    amplitude = 0.1
)</code></pre><h2 id="From-Spectra"><a class="docs-heading-anchor" href="#From-Spectra">From Spectra</a><a id="From-Spectra-1"></a><a class="docs-heading-anchor-permalink" href="#From-Spectra" title="Permalink"></a></h2><h3 id="Prescribed-Energy-Spectrum"><a class="docs-heading-anchor" href="#Prescribed-Energy-Spectrum">Prescribed Energy Spectrum</a><a id="Prescribed-Energy-Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Prescribed-Energy-Spectrum" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Initialize with E(k) ~ k^(-3)
initialize_from_spectrum!(state, grid;
    spectrum_type = :power_law,
    exponent = -3,
    energy_level = 1.0
)</code></pre><h3 id="Realistic-Spectrum"><a class="docs-heading-anchor" href="#Realistic-Spectrum">Realistic Spectrum</a><a id="Realistic-Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Realistic-Spectrum" title="Permalink"></a></h3><pre><code class="language-julia hljs"># ECCO-like spectrum
initialize_from_spectrum!(state, grid;
    spectrum_type = :ECCO,
    energy_level = 1.0
)</code></pre><h2 id="From-Data"><a class="docs-heading-anchor" href="#From-Data">From Data</a><a id="From-Data-1"></a><a class="docs-heading-anchor-permalink" href="#From-Data" title="Permalink"></a></h2><h3 id="From-NetCDF"><a class="docs-heading-anchor" href="#From-NetCDF">From NetCDF</a><a id="From-NetCDF-1"></a><a class="docs-heading-anchor-permalink" href="#From-NetCDF" title="Permalink"></a></h3><pre><code class="language-julia hljs">using NCDatasets

# Load from file
NCDataset(&quot;initial_conditions.nc&quot;) do ds
    psi_init = ds[&quot;psi&quot;][:]
    B_init = ds[&quot;B&quot;][:]
end

# Set state
state.psi .= psi_init
state.B .= B_init

# Compute derived quantities
invert_q_to_psi!(state, grid, params, a_ell)
compute_velocities!(state, grid, plans)</code></pre><h3 id="Interpolation-from-Different-Grid"><a class="docs-heading-anchor" href="#Interpolation-from-Different-Grid">Interpolation from Different Grid</a><a id="Interpolation-from-Different-Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolation-from-Different-Grid" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Interpolate from coarse to fine grid
psi_fine = interpolate_field(psi_coarse, grid_coarse, grid_fine)
state.psi .= psi_fine</code></pre><h2 id="Spin-Up"><a class="docs-heading-anchor" href="#Spin-Up">Spin-Up</a><a id="Spin-Up-1"></a><a class="docs-heading-anchor-permalink" href="#Spin-Up" title="Permalink"></a></h2><p>For realistic simulations, start with random initialization and spin up:</p><pre><code class="language-julia hljs"># Initialize randomly
initialize_random_flow!(state, grid; energy_level=0.1)

# Spin-up phase (develop turbulence)
for step = 1:spinup_steps
    timestep!(state, grid, params, work, plans, a_ell, dt)
end

# Now add waves
initialize_random_waves!(state, grid; amplitude=0.1)

# Production run
for step = 1:nsteps
    timestep!(...)
end</code></pre><h2 id="Verification"><a class="docs-heading-anchor" href="#Verification">Verification</a><a id="Verification-1"></a><a class="docs-heading-anchor-permalink" href="#Verification" title="Permalink"></a></h2><h3 id="Check-Initial-Energy"><a class="docs-heading-anchor" href="#Check-Initial-Energy">Check Initial Energy</a><a id="Check-Initial-Energy-1"></a><a class="docs-heading-anchor-permalink" href="#Check-Initial-Energy" title="Permalink"></a></h3><pre><code class="language-julia hljs">KE = flow_kinetic_energy(state.u, state.v, grid)
WE = wave_energy(state.B, state.A, grid)[2]

println(&quot;Initial KE: $KE&quot;)
println(&quot;Initial WE: $WE&quot;)</code></pre><h3 id="Visualize"><a class="docs-heading-anchor" href="#Visualize">Visualize</a><a id="Visualize-1"></a><a class="docs-heading-anchor-permalink" href="#Visualize" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Plots

# Surface vorticity
zeta = compute_vorticity(state.psi, grid, plans)
heatmap(zeta[:, :, end], title=&quot;Initial Surface Vorticity&quot;)

# Wave amplitude
A2 = abs2.(state.A)
heatmap(A2[:, :, end], title=&quot;Initial Wave Intensity&quot;)</code></pre><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><p>Initial conditions can be set using:</p><ul><li><code>init_random_psi!</code> - Initialize random streamfunction field</li><li>Direct assignment to <code>state.q</code>, <code>state.B</code> in spectral space</li><li>Reading from NetCDF files using <code>ncread_psi!</code>, <code>ncread_la!</code></li></ul><p>See the <a href="../../api/grid_state/">Grid &amp; State API</a> for state initialization functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../stratification/">« Stratification</a><a class="docs-footer-nextpage" href="../simulation/">Running Simulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 18 December 2025 19:55">Thursday 18 December 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
