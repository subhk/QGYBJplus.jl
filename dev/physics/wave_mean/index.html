<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wave-Mean Interaction · QGYBJ.jl</title><meta name="title" content="Wave-Mean Interaction · QGYBJ.jl"/><meta property="og:title" content="Wave-Mean Interaction · QGYBJ.jl"/><meta property="twitter:title" content="Wave-Mean Interaction · QGYBJ.jl"/><meta name="description" content="Documentation for QGYBJ.jl."/><meta property="og:description" content="Documentation for QGYBJ.jl."/><meta property="twitter:description" content="Documentation for QGYBJ.jl."/><meta property="og:url" content="https://subhk.github.io/QGYBJ.jl/stable/physics/wave_mean/"/><meta property="twitter:url" content="https://subhk.github.io/QGYBJ.jl/stable/physics/wave_mean/"/><link rel="canonical" href="https://subhk.github.io/QGYBJ.jl/stable/physics/wave_mean/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">QGYBJ.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/">Installation</a></li><li><a class="tocitem" href="../../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../../worked_example/">Worked Example</a></li></ul></li><li><span class="tocitem">Physics &amp; Theory</span><ul><li><a class="tocitem" href="../overview/">Model Overview</a></li><li><a class="tocitem" href="../qg_equations/">QG Equations</a></li><li><a class="tocitem" href="../ybj_plus/">YBJ+ Wave Model</a></li><li class="is-active"><a class="tocitem" href>Wave-Mean Interaction</a><ul class="internal"><li><a class="tocitem" href="#Physical-Motivation"><span>Physical Motivation</span></a></li><li><a class="tocitem" href="#The-Wave-Feedback-Term"><span>The Wave Feedback Term</span></a></li><li><a class="tocitem" href="#Energy-Exchange"><span>Energy Exchange</span></a></li><li><a class="tocitem" href="#Refraction-Mechanism"><span>Refraction Mechanism</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Scaling-Analysis"><span>Scaling Analysis</span></a></li><li><a class="tocitem" href="#Coupled-Dynamics"><span>Coupled Dynamics</span></a></li><li><a class="tocitem" href="#Diagnostics"><span>Diagnostics</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../numerical_methods/">Numerical Methods</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../guide/configuration/">Configuration</a></li><li><a class="tocitem" href="../../guide/stratification/">Stratification</a></li><li><a class="tocitem" href="../../guide/initial_conditions/">Initial Conditions</a></li><li><a class="tocitem" href="../../guide/simulation/">Running Simulations</a></li><li><a class="tocitem" href="../../guide/io/">I/O and Output</a></li><li><a class="tocitem" href="../../guide/diagnostics/">Diagnostics</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../../advanced/parallel/">MPI Parallelization</a></li><li><a class="tocitem" href="../../advanced/particles/">Particle Advection</a></li><li><a class="tocitem" href="../../advanced/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../advanced/performance/">Performance Tips</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/types/">Core Types</a></li><li><a class="tocitem" href="../../api/grid_state/">Grid &amp; State</a></li><li><a class="tocitem" href="../../api/physics/">Physics Functions</a></li><li><a class="tocitem" href="../../api/timestepping/">Time Stepping</a></li><li><a class="tocitem" href="../../api/particles/">Particles</a></li><li><a class="tocitem" href="../../api/">Full Index</a></li></ul></li><li><a class="tocitem" href="../../troubleshooting/">Troubleshooting</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Physics &amp; Theory</a></li><li class="is-active"><a href>Wave-Mean Interaction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wave-Mean Interaction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/subhk/QGYBJ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/subhk/QGYBJ.jl/blob/main/docs/src/physics/wave_mean.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="wave-mean"><a class="docs-heading-anchor" href="#wave-mean">Wave-Mean Interaction</a><a id="wave-mean-1"></a><a class="docs-heading-anchor-permalink" href="#wave-mean" title="Permalink"></a></h1><p>This page describes the two-way coupling between near-inertial waves and the balanced mean flow.</p><h2 id="Physical-Motivation"><a class="docs-heading-anchor" href="#Physical-Motivation">Physical Motivation</a><a id="Physical-Motivation-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Motivation" title="Permalink"></a></h2><h3 id="Why-Waves-Affect-the-Mean-Flow"><a class="docs-heading-anchor" href="#Why-Waves-Affect-the-Mean-Flow">Why Waves Affect the Mean Flow</a><a id="Why-Waves-Affect-the-Mean-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Why-Waves-Affect-the-Mean-Flow" title="Permalink"></a></h3><p>Near-inertial waves carry momentum and energy. When they:</p><ul><li><strong>Break</strong> or dissipate</li><li><strong>Refract</strong> through vorticity gradients</li><li><strong>Interact nonlinearly</strong> with the flow</li></ul><p>...they can transfer energy and momentum to the balanced circulation.</p><h3 id="Observational-Evidence"><a class="docs-heading-anchor" href="#Observational-Evidence">Observational Evidence</a><a id="Observational-Evidence-1"></a><a class="docs-heading-anchor-permalink" href="#Observational-Evidence" title="Permalink"></a></h3><ul><li>Anticyclones contain <strong>enhanced</strong> NIW energy (chimney effect)</li><li>Wave dissipation correlates with <strong>mixing</strong> in anticyclones</li><li>Waves can <strong>energize</strong> the mesoscale eddy field</li></ul><h2 id="The-Wave-Feedback-Term"><a class="docs-heading-anchor" href="#The-Wave-Feedback-Term">The Wave Feedback Term</a><a id="The-Wave-Feedback-Term-1"></a><a class="docs-heading-anchor-permalink" href="#The-Wave-Feedback-Term" title="Permalink"></a></h2><h3 id="Definition"><a class="docs-heading-anchor" href="#Definition">Definition</a><a id="Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Definition" title="Permalink"></a></h3><p>The wave-induced potential vorticity is:</p><p class="math-container">\[q^w = \frac{1}{2}\nabla_h^2|A|^2 - \frac{1}{2}\frac{\partial^2|A|^2}{\partial z^2}\]</p><p>This enters the QG equation as:</p><p class="math-container">\[\frac{\partial q}{\partial t} + J(\psi, q) + J(\psi, q^w) = \mathcal{D}_q\]</p><h3 id="Physical-Interpretation"><a class="docs-heading-anchor" href="#Physical-Interpretation">Physical Interpretation</a><a id="Physical-Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Interpretation" title="Permalink"></a></h3><table><tr><th style="text-align: left">Term</th><th style="text-align: left">Meaning</th></tr><tr><td style="text-align: left"><span>$\nabla_h^2|A|^2$</span></td><td style="text-align: left">Horizontal wave intensity curvature</td></tr><tr><td style="text-align: left"><span>$\partial_z^2|A|^2$</span></td><td style="text-align: left">Vertical wave intensity curvature</td></tr><tr><td style="text-align: left"><span>$J(\psi, q^w)$</span></td><td style="text-align: left">Advection of wave-induced PV</td></tr></table><p>The wave feedback represents:</p><ul><li><strong>Radiation stress</strong> from wave momentum flux</li><li><strong>Form drag</strong> from wave-induced pressure fluctuations</li></ul><h2 id="Energy-Exchange"><a class="docs-heading-anchor" href="#Energy-Exchange">Energy Exchange</a><a id="Energy-Exchange-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-Exchange" title="Permalink"></a></h2><h3 id="Wave-to-Flow-Transfer"><a class="docs-heading-anchor" href="#Wave-to-Flow-Transfer">Wave-to-Flow Transfer</a><a id="Wave-to-Flow-Transfer-1"></a><a class="docs-heading-anchor-permalink" href="#Wave-to-Flow-Transfer" title="Permalink"></a></h3><p>Energy flows from waves to mean flow when:</p><p class="math-container">\[\mathcal{E}_{w \to f} = -\int \psi \cdot J(\psi, q^w) \, dV\]</p><p>This can be positive or negative:</p><ul><li><strong>Positive</strong>: Waves energize the flow</li><li><strong>Negative</strong>: Flow energizes waves (less common)</li></ul><h3 id="Conservation"><a class="docs-heading-anchor" href="#Conservation">Conservation</a><a id="Conservation-1"></a><a class="docs-heading-anchor-permalink" href="#Conservation" title="Permalink"></a></h3><p>In the inviscid limit, total energy is conserved:</p><p class="math-container">\[\frac{d}{dt}(E_{flow} + E_{wave}) = 0\]</p><p>The wave feedback term merely <strong>redistributes</strong> energy.</p><h2 id="Refraction-Mechanism"><a class="docs-heading-anchor" href="#Refraction-Mechanism">Refraction Mechanism</a><a id="Refraction-Mechanism-1"></a><a class="docs-heading-anchor-permalink" href="#Refraction-Mechanism" title="Permalink"></a></h2><h3 id="How-Eddies-Focus-Waves"><a class="docs-heading-anchor" href="#How-Eddies-Focus-Waves">How Eddies Focus Waves</a><a id="How-Eddies-Focus-Waves-1"></a><a class="docs-heading-anchor-permalink" href="#How-Eddies-Focus-Waves" title="Permalink"></a></h3><p>Anticyclones (negative vorticity) trap waves:</p><ol><li><strong>Effective frequency</strong> is reduced: <span>$f_{eff} = f_0 + \zeta/2$</span></li><li>Waves propagate toward <strong>lower</strong> effective frequency</li><li>Energy <strong>accumulates</strong> in anticyclone cores</li></ol><h3 id="The-Chimney-Effect"><a class="docs-heading-anchor" href="#The-Chimney-Effect">The Chimney Effect</a><a id="The-Chimney-Effect-1"></a><a class="docs-heading-anchor-permalink" href="#The-Chimney-Effect" title="Permalink"></a></h3><pre><code class="nohighlight hljs">         Wind Forcing
              ↓
    ┌─────────────────────┐
    │   Surface Layer     │
    └─────────┬───────────┘
              │
    ┌─────────┼───────────┐
    │    ↙    ↓    ↘      │  ← Waves spread horizontally
    │   ↙     ↓     ↘     │
    └──↙──────┼──────↘────┘
       ↘      ↓      ↙
        ↘     ↓     ↙
         ↘    ↓    ↙        ← Anticyclone focuses waves
    ┌─────────┼───────────┐
    │         ↓           │
    │    Anticyclone      │  ← Enhanced dissipation
    │      (ζ &lt; 0)        │
    └─────────────────────┘</code></pre><p>Waves are funneled into anticyclones, enhancing deep mixing.</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="Computing-Wave-Feedback"><a class="docs-heading-anchor" href="#Computing-Wave-Feedback">Computing Wave Feedback</a><a id="Computing-Wave-Feedback-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-Wave-Feedback" title="Permalink"></a></h3><pre><code class="language-julia hljs"># In nonlinear.jl
function wavefb!(rqk, A, grid, params, plans)
    # Compute |A|²
    compute_wave_intensity!(A2, A, plans)

    # Compute ∇²|A|² (horizontal Laplacian)
    horizontal_laplacian!(lap_A2, A2, grid)

    # Compute ∂²|A|²/∂z² (vertical second derivative)
    vertical_second_deriv!(d2z_A2, A2, grid)

    # Wave-induced PV: qw = 0.5*(∇²|A|² - ∂²|A|²/∂z²)
    @. qw = 0.5 * (lap_A2 - d2z_A2)

    # Add J(ψ, qw) to tendency
    jacobian_spectral!(rqk, psi, qw, ...)
end</code></pre><h3 id="Enabling/Disabling"><a class="docs-heading-anchor" href="#Enabling/Disabling">Enabling/Disabling</a><a id="Enabling/Disabling-1"></a><a class="docs-heading-anchor-permalink" href="#Enabling/Disabling" title="Permalink"></a></h3><pre><code class="language-julia hljs"># With wave feedback (default)
params = QGParams(; no_feedback=false)

# Without wave feedback
params = QGParams(; no_feedback=true)</code></pre><p>Disabling is useful for:</p><ul><li>Studying one-way wave-flow interaction</li><li>Isolating wave dynamics from flow effects</li><li>Computational efficiency when feedback is weak</li></ul><h2 id="Scaling-Analysis"><a class="docs-heading-anchor" href="#Scaling-Analysis">Scaling Analysis</a><a id="Scaling-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Scaling-Analysis" title="Permalink"></a></h2><h3 id="When-is-Feedback-Important?"><a class="docs-heading-anchor" href="#When-is-Feedback-Important?">When is Feedback Important?</a><a id="When-is-Feedback-Important?-1"></a><a class="docs-heading-anchor-permalink" href="#When-is-Feedback-Important?" title="Permalink"></a></h3><p>The feedback strength scales as:</p><p class="math-container">\[\frac{|q^w|}{|q|} \sim \left(\frac{A_0}{U}\right)^2 \cdot \left(\frac{L_w}{L}\right)^2\]</p><p>where:</p><ul><li><span>$A_0/U$</span>: Wave-to-flow velocity ratio</li><li><span>$L_w/L$</span>: Wave-to-eddy length ratio</li></ul><p>Feedback matters when:</p><ul><li>Strong wind forcing (large <span>$A_0$</span>)</li><li>Compact wave packets (small <span>$L_w$</span>)</li><li>Weak background flow (small <span>$U$</span>)</li></ul><h3 id="Typical-Values"><a class="docs-heading-anchor" href="#Typical-Values">Typical Values</a><a id="Typical-Values-1"></a><a class="docs-heading-anchor-permalink" href="#Typical-Values" title="Permalink"></a></h3><table><tr><th style="text-align: left">Scenario</th><th style="text-align: left">Wave Feedback</th></tr><tr><td style="text-align: left">Weak winds, strong eddies</td><td style="text-align: left">Negligible</td></tr><tr><td style="text-align: left">Storm forcing</td><td style="text-align: left">Moderate (1-10%)</td></tr><tr><td style="text-align: left">Tropical cyclone</td><td style="text-align: left">Strong (10-50%)</td></tr></table><h2 id="Coupled-Dynamics"><a class="docs-heading-anchor" href="#Coupled-Dynamics">Coupled Dynamics</a><a id="Coupled-Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Coupled-Dynamics" title="Permalink"></a></h2><h3 id="Feedback-Loop"><a class="docs-heading-anchor" href="#Feedback-Loop">Feedback Loop</a><a id="Feedback-Loop-1"></a><a class="docs-heading-anchor-permalink" href="#Feedback-Loop" title="Permalink"></a></h3><pre><code class="nohighlight hljs">┌──────────────┐         ┌──────────────┐
│              │         │              │
│   Eddies     │◄────────│    Waves     │
│   (ψ, q)     │         │   (A, B)     │
│              │         │              │
└──────┬───────┘         └──────┬───────┘
       │                        │
       │ Refraction             │ Feedback
       │ ∂ζ/∂t                  │ qw
       │                        │
       ▼                        ▼
┌──────────────────────────────────────┐
│                                      │
│       Wave-Mean Energy Exchange      │
│                                      │
└──────────────────────────────────────┘</code></pre><h3 id="Equilibration"><a class="docs-heading-anchor" href="#Equilibration">Equilibration</a><a id="Equilibration-1"></a><a class="docs-heading-anchor-permalink" href="#Equilibration" title="Permalink"></a></h3><p>The coupled system can reach statistical equilibrium where:</p><ul><li>Wave generation (wind) balances dissipation</li><li>Energy flux from waves to flow balances eddy dissipation</li><li>Net energy is constant on average</li></ul><h2 id="Diagnostics"><a class="docs-heading-anchor" href="#Diagnostics">Diagnostics</a><a id="Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics" title="Permalink"></a></h2><h3 id="Monitoring-Energy-Exchange"><a class="docs-heading-anchor" href="#Monitoring-Energy-Exchange">Monitoring Energy Exchange</a><a id="Monitoring-Energy-Exchange-1"></a><a class="docs-heading-anchor-permalink" href="#Monitoring-Energy-Exchange" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Compute wave feedback contribution
qw = compute_wave_pv(state.A, grid)

# Energy exchange rate
exchange_rate = compute_energy_exchange(state.psi, qw, grid, plans)</code></pre><h3 id="Typical-Analysis"><a class="docs-heading-anchor" href="#Typical-Analysis">Typical Analysis</a><a id="Typical-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Typical-Analysis" title="Permalink"></a></h3><ol><li>Track <span>$E_{flow}$</span> and <span>$E_{wave}$</span> over time</li><li>Compute their time derivatives</li><li>Compare with wave feedback term to verify energy conservation</li></ol><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Xie, J.-H., &amp; Vanneste, J. (2015). A generalised-Lagrangian-mean model of the interactions between near-inertial waves and mean flow. <em>J. Fluid Mech.</em>, 774, 143-169.</li><li>Wagner, G. L., &amp; Young, W. R. (2016). A three-component model for the coupled evolution of near-inertial waves, quasi-geostrophic flow and the near-inertial second harmonic. <em>J. Fluid Mech.</em>, 802, 806-837.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ybj_plus/">« YBJ+ Wave Model</a><a class="docs-footer-nextpage" href="../numerical_methods/">Numerical Methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 15 December 2025 07:31">Monday 15 December 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
